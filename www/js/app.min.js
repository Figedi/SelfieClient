!function e(r,t,a){function i(n,c){if(!t[n]){if(!r[n]){var s="function"==typeof require&&require;if(!c&&s)return s(n,!0);if(o)return o(n,!0);throw new Error("Cannot find module '"+n+"'")}var u=t[n]={exports:{}};r[n][0].call(u.exports,function(e){var t=r[n][1][e];return i(t?t:e)},u,u.exports,e,r,t,a)}return t[n].exports}for(var o="function"==typeof require&&require,n=0;n<a.length;n++)i(a[n]);return i}({1:[function(e){"use strict";var r,t,a,i,o,n,c,s,u;n=e("./config/static.coffee"),c=e("./factories/cordova_ready.coffee"),i=e("./factories/camera_data.coffee"),s=e("./factories/overlay.coffee"),u=e("./factories/selfie_server.coffee"),a=e("./directives/camera_API.coffee"),o=e("./directives/canvas_screenshot.coffee"),r=e("./controllers/main_ctrl.coffee"),t=angular.module("selfieApp",["onsen.directives"]),t.config(["$sceDelegateProvider",function(e){return e.resourceUrlWhitelist(["self",/^\s*(blob|https?):|data:image\//])}]),t.constant("Config",n),t.factory("cordovaReady",c),t.factory("cameraData",i),t.factory("overlay",s),t.factory("Server",u),t.directive("camera",a),t.directive("usermedia",o),t.controller("MainCtrl",r)},{"./config/static.coffee":2,"./controllers/main_ctrl.coffee":3,"./directives/camera_API.coffee":4,"./directives/canvas_screenshot.coffee":5,"./factories/camera_data.coffee":6,"./factories/cordova_ready.coffee":7,"./factories/overlay.coffee":8,"./factories/selfie_server.coffee":9}],2:[function(e,r){var t;t={serverIP:"http://141.83.80.129",base64Regex:/^(?:data\:[^,]+,)?(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/,phonegap:{CameraDefaults:{PictureSourceType:{PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},DestinationType:{DATA_URL:0,FILE_URI:1,NATIVE_URI:2},EncodingType:{JPEG:0,PNG:1},MediaType:{PICTURE:0,VIDEO:1,ALLMEDIA:2},Direction:{BACK:0,FRONT:1}}}},t.phonegap.defaultOptions={quality:50,destinationType:t.phonegap.CameraDefaults.DestinationType.DATA_URL,sourceType:t.phonegap.CameraDefaults.PictureSourceType.CAMERA,encodingType:t.phonegap.CameraDefaults.EncodingType.PNG,cameraDirection:t.phonegap.CameraDefaults.Direction.FRONT},r.exports=t},{}],3:[function(e,r){"use strict";var t;e("../config/static"),e("../factories/overlay"),e("../factories/selfie_server"),t=["$scope","Server","Config","overlay",function(e,r,t,a){var i,o,n;return o=function(e){return t.base64Regex.test(e)},n=function(t){return e.server.uploadRequested=!0,r.upload(t).success(function(r){return a.show("Vielen Dank für dein Selfie!"),e.server.fileName=r.file.name,e.server.uploadRequested=!1}).error(function(){return a.show({text:"Hochladen fehlgeschlagen, versuch's doch nochmal!",type:"error"}),e.server.fileName="",e.server.uploadRequested=!1})},i=function(t){return e.server.uploadRequested=!0,r.email(t).success(function(){return a.show("Hochladen erfolgreich!"),e.server.uploadRequested=!1,selfieNav.popPage(),e.test.imageSrc=null,e.userMedia.imageAvailable=!1}).error(function(){return e.server.fileName="",e.server.uploadRequested=!1,a.show({text:"Hochladen fehlgeschlagen, versuch's doch nochmal!",type:"error"})})},e.test={imageSrc:null},e.userMedia={videoAvailable:!1,imageAvailable:!1,videoBlob:null},e.server={uploadRequested:!1,fileName:"",email:""},e.$watch("test.imageSrc",function(){return e.test.imageSrc?n({image:e.test.imageSrc,email:e.server.email}):void 0}),e.onUploadClick=function(){return!e.server.uploadRequested&&e.test.imageSrc?selfieNav.pushPage("html/email_modal.html",{animation:"slide"}):void 0},e.onEmailClick=function(){var r;if(!e.server.uploadRequested)return r=e.server.fileName?{name:e.server.fileName,email:e.server.email}:{image:e.test.imageSrc,name:e.server.fileName,email:e.server.email},i(r)},e.onDestroyClick=function(){return e.test.imageSrc=null,e.userMedia.imageAvailable=!1}}],r.exports=t},{"../config/static":2,"../factories/overlay":8,"../factories/selfie_server":9}],4:[function(e,r){"use strict";var t;e("../config/static"),e("../factories/cordova_ready"),e("../factories/camera_data"),e("../factories/overlay"),t=["cordovaReady","Config","cameraData","overlay",function(e,r,t,a){var i,o,n,c,s,u,f;return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,n=function(e,r){return{video:{mandatory:{minWidth:e,maxWidth:e,minHeight:r,maxHeight:r}},audio:!1}},o=function(e,r){var t,a,i,o;return o=[e[0].width,e[0].height],a=o[0],t=o[1],i=document.querySelector("video"),i.setAttribute("width",a),i.setAttribute("height",t),navigator.getUserMedia(n(a,t),f(r),u(r))},f=function(e){return function(r){return t.videoStream=r,t.videoBlob=URL.createObjectURL(r),e.userMedia.videoBlob=URL.createObjectURL(r),e.userMedia.videoAvailable=!0,e.$apply(),t.videoRequested=!1}},u=function(e){return function(r){return console.log("err usermedia",r),t.videoRequested=!1,navigator.camera?i(e):(a.show("DevicesNotFoundError"===r.name?{type:"error",text:"Keine Kamera verfügbar"}:{type:"error",text:"Kamerafehler!"}),e.imageSrc=null,e.userMedia.imageAvailable=!1,e.$apply())}},i=function(t){return e.ready().then(function(){return navigator.camera.getPicture(s(t),c,r.phonegap.defaultOptions)})},s=function(r){return function(t){return console.log("success phonegap"),r.userMedia.imageAvailable=!0,r.imageSrc="data:image/png;base64,"+t,r.$apply(),e.ready().then(function(){return navigator.camera.cleanup(function(){},function(){})})}},c=function(){return toast.show({type:"error",text:"Kamerafehler :("}),scope.imageSrc=null,scope.userMedia.imageAvailable=!1,scope.$apply()},{restrict:"A",link:function(e,r){return r.on("click",function(){return t.videoRequested||e.server.uploadRequested?void 0:(e.userMedia.imageAvailable=!1,navigator.getUserMedia?(t.videoRequested=!0,o(r,e)):i(e))})}}}],r.exports=t},{"../config/static":2,"../factories/camera_data":6,"../factories/cordova_ready":7,"../factories/overlay":8}],5:[function(e,r){"use strict";var t;e("../config/static"),e("../factories/camera_data"),t=["Config","cameraData",function(e,r){var t,a,i;return t=document.createElement("canvas"),a=t.getContext("2d"),i=function(e){var r,i,o;return o=[e.width,e.height],i=o[0],r=o[1],t.width=i,t.height=r,a.drawImage(e,0,0,i,r),t.toDataURL("image/png")},{restrict:"A",link:function(e,t){return t.on("click",function(){return t[0].pause(),r.videoStream&&(r.videoStream.stop(),r.videoStream=null),e.test.imageSrc=i(t[0]),e.userMedia.imageAvailable=!0,e.userMedia.videoBlob=null,e.userMedia.videoAvailable=!1,e.$apply(),r.videoRequested=!1})}}}],r.exports=t},{"../config/static":2,"../factories/camera_data":6}],6:[function(e,r){r.exports=[function(){return{}}]},{}],7:[function(e,r){var t;t=["$q","$rootScope","$document",function(e,r,t){var a;return a=e.defer(),t.bind("deviceready",function(){return r.$apply(a.resolve)}),{ready:function(){return a.promise}}}],r.exports=t},{}],8:[function(e,r){var t;t=["$timeout","$rootScope","$rootElement","$compile","$window",function(e,r,t,a){var i,o,n,c,s;return i={SUCCESS_CLASS:"fa fa-check fa-5x",ERROR_CLASS:"fa fa-times fa-5x"},o={duration:3e3,type:"success",text:"Success!",$scope:r.$new()},c=null,s=function(r,a){var i;return(i=document.querySelector(".toast"))&&i.remove(),a.addClass("toast-show"),t.append(a),c&&e.cancel(c),c=e(function(){return a.removeClass("toast-show").addClass("toast-hide"),e(function(){return document.querySelector(".toast").remove()},750),c=null},r)},n=function(e){var r,t,o,n;return n="success"===e.type?i.SUCCESS_CLASS:i.ERROR_CLASS,o='<div class="toast">\n  <i class="'+n+'"></i>\n  <span>'+e.text+"</span>\n</div>",r=e.$scope,t=a(o)(r),s(e.duration,t)},{show:function(e){return"string"==typeof e&&(e={text:e}),e=angular.extend(o,e),n(e)}}}],r.exports=t},{}],9:[function(e,r){var t;e("../config/static"),t=["$http","Config",function(e,r){return{upload:function(t){var a;return a={method:"POST",timeout:5e3,url:""+r.serverIP+"/upload",data:{b64:t.image,email:t.email}},e(a)},email:function(t){var a;return a={method:"POST",url:""+r.serverIP+"/email",data:{name:t.name,email:t.email}},e(a)}}}],r.exports=t},{"../config/static":2}]},{},[1]);