!function e(a,t,r){function o(n,c){if(!t[n]){if(!a[n]){var u="function"==typeof require&&require;if(!c&&u)return u(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=t[n]={exports:{}};a[n][0].call(s.exports,function(e){var t=a[n][1][e];return o(t?t:e)},s,s.exports,e,a,t,r)}return t[n].exports}for(var i="function"==typeof require&&require,n=0;n<r.length;n++)o(r[n]);return o}({1:[function(e){"use strict";var a,t,r,o,i,n;r=e("./config/static.coffee"),n=e("./factories/cordova_ready.coffee"),t=e("./factories/camera_data.coffee"),i=e("./directives/camera.coffee"),o=e("./controllers/main_ctrl.coffee"),a=angular.module("selfieApp",["ngTouch"]),a.config(["$sceDelegateProvider",function(e){return e.resourceUrlWhitelist(["self",/^\s*(blob|https?):|data:image\//])}]),a.constant("Config",r.config),a.factory("cordovaReady",n.cordovaReady),a.factory("cameraData",t.cameraData),a.directive("camera",i.camera),a.directive("usermedia",i.usermedia),a.controller("MainCtrl",o.MainCtrl)},{"./config/static.coffee":2,"./controllers/main_ctrl.coffee":3,"./directives/camera.coffee":4,"./factories/camera_data.coffee":5,"./factories/cordova_ready.coffee":6}],2:[function(e,a,t){var r;r={serverIP:"http://141.83.80.129",imageSrc:"img/selfie.png",base64Regex:/^(?:data\:[^,]+,)?(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/,phonegap:{CameraDefaults:{PictureSourceType:{PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},DestinationType:{DATA_URL:0,FILE_URI:1,NATIVE_URI:2},EncodingType:{JPEG:0,PNG:1},MediaType:{PICTURE:0,VIDEO:1,ALLMEDIA:2},Direction:{BACK:0,FRONT:1}}}},r.phonegap.defaultOptions={quality:50,destinationType:r.phonegap.CameraDefaults.DestinationType.FILE_URL,sourceType:r.phonegap.CameraDefaults.PictureSourceType.CAMERA,encodingType:r.phonegap.CameraDefaults.EncodingType.JPEG,cameraDirection:r.phonegap.CameraDefaults.Direction.FRONT},t.config=r},{}],3:[function(e,a,t){"use strict";e("../config/static"),t.MainCtrl=["$scope","$http","Config",function(e,a,t){var r,o;return o=function(){return t.base64Regex.test(e.imageSrc)},r=1,e.imageSrc=t.imageSrc,e.videoStream="",e.imageAvailable=!1,e.uploadRequested=!1,e.onUploadClick=function(){var r;return console.log("scope.imageSrc",e.imageSrc),e.uploadRequested?void 0:o()?(e.uploadRequested=!0,r={method:"POST",timeout:2e4,url:""+t.serverIP+"/upload",data:{b64:e.imageSrc}},a(r).success(function(){return console.log("it works"),e.uploadRequested=!1}).error(function(){return e.uploadRequested=!1,console.log("it doesnt work")})):console.log("no b64 image")},e.onDestroyClick=function(){return e.imageSrc=t.imageSrc,e.imageAvailable=!1}}]},{"../config/static":2}],4:[function(e,a,t){"use strict";e("../config/static"),e("../factories/cordova_ready"),e("../factories/camera_data"),t.camera=["cordovaReady","Config","cameraData","$timeout",function(e,a,t){var r,o,i,n,c,u,s;return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,i=function(e,a){return{video:{mandatory:{minWidth:e,maxWidth:e,minHeight:a,maxHeight:a}},audio:!1}},o=function(e,a){var t,r,o,n;return n=[e[0].width,e[0].height],r=n[0],t=n[1],o=document.querySelector("video"),o.setAttribute("width",r),o.setAttribute("height",t),navigator.getUserMedia(i(r,t),s(a),u(a))},s=function(e){return function(a){return console.log("success"),t.videoStream=a,t.videoBlob=URL.createObjectURL(a),e.videoStream=URL.createObjectURL(a),e.$apply(),t.videoRequested=!1}},u=function(e){return function(o){return console.log("err usermedia",o),t.videoRequested=!1,navigator.camera?r(e):(console.log("No phonegap or usermedia available"),e.imageSrc=a.imageSrc,e.imageAvailable=!1,e.$apply())}},r=function(t){return e.ready().then(function(){return navigator.camera.getPicture(c(t),n,a.phonegap.defaultOptions)})},c=function(a){return function(t){return console.log("success phonegap"),a.imageAvailable=!0,a.imageSrc=t,a.$apply(),e.ready().then(function(){return navigator.camera.cleanup(function(){},function(){})})}},n=function(e){return console.log("err phonegap",e),scope.imageSrc=a.imageSrc,scope.imageAvailable=!1,scope.$apply()},{restrict:"A",link:function(e,a){return a.on("click",function(){return console.log("click :)",t.videoRequested,e.uploadRequested),t.videoRequested||e.uploadRequested?void 0:(e.imageAvailable=!1,navigator.getUserMedia?(t.videoRequested=!0,o(a,e)):r(e))})}}}],t.usermedia=["Config","cameraData",function(e,a){var t,r,o;return t=document.createElement("canvas"),r=t.getContext("2d"),o=function(e){var a,o,i;return i=[e.width,e.height],o=i[0],a=i[1],t.width=o,t.height=a,r.drawImage(e,0,0,o,a),t.toDataURL("image/png")},{restrict:"A",link:function(e,t){return t.on("click",function(){return e.imageSrc=o(t[0]),t[0].pause(),a.videoStream&&(a.videoStream.stop(),a.videoStream=null),e.imageAvailable=!0,e.videoStream=null,e.imageAvailable=!0,e.$apply(),a.videoRequested=!1})}}}]},{"../config/static":2,"../factories/camera_data":5,"../factories/cordova_ready":6}],5:[function(e,a,t){t.cameraData=[function(){return{}}]},{}],6:[function(e,a,t){t.cordovaReady=["$q","$rootScope","$document",function(e,a,t){var r;return r=e.defer(),t.bind("deviceready",function(){return a.$apply(r.resolve)}),{ready:function(){return r.promise}}}]},{}]},{},[1]);