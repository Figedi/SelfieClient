!function e(a,t,r){function o(n,c){if(!t[n]){if(!a[n]){var u="function"==typeof require&&require;if(!c&&u)return u(n,!0);if(i)return i(n,!0);throw new Error("Cannot find module '"+n+"'")}var s=t[n]={exports:{}};a[n][0].call(s.exports,function(e){var t=a[n][1][e];return o(t?t:e)},s,s.exports,e,a,t,r)}return t[n].exports}for(var i="function"==typeof require&&require,n=0;n<r.length;n++)o(r[n]);return o}({1:[function(e){"use strict";var a,t,r,o,i,n,c,u;n=e("./config/static.coffee"),c=e("./factories/cordova_ready.coffee"),o=e("./factories/camera_data.coffee"),u=e("./factories/overlay.coffee"),r=e("./directives/camera_API.coffee"),i=e("./directives/canvas_screenshot.coffee"),a=e("./controllers/main_ctrl.coffee"),t=angular.module("selfieApp",["ngTouch","ng.picturefill","ngDialog"]),t.config(["$sceDelegateProvider",function(e){return e.resourceUrlWhitelist(["self",/^\s*(blob|https?):|data:image\//])}]),t.constant("Config",n),t.factory("cordovaReady",c),t.factory("cameraData",o),t.factory("overlay",u),t.directive("camera",r),t.directive("usermedia",i),t.controller("MainCtrl",a)},{"./config/static.coffee":2,"./controllers/main_ctrl.coffee":3,"./directives/camera_API.coffee":4,"./directives/canvas_screenshot.coffee":5,"./factories/camera_data.coffee":6,"./factories/cordova_ready.coffee":7,"./factories/overlay.coffee":8}],2:[function(e,a){var t;t={serverIP:"http://localhost:3000",imageSrc:"img/selfie.png",base64Regex:/^(?:data\:[^,]+,)?(?:[A-Za-z0-9+\/]{4})*(?:[A-Za-z0-9+\/]{2}==|[A-Za-z0-9+\/]{3}=)?$/,phonegap:{CameraDefaults:{PictureSourceType:{PHOTOLIBRARY:0,CAMERA:1,SAVEDPHOTOALBUM:2},DestinationType:{DATA_URL:0,FILE_URI:1,NATIVE_URI:2},EncodingType:{JPEG:0,PNG:1},MediaType:{PICTURE:0,VIDEO:1,ALLMEDIA:2},Direction:{BACK:0,FRONT:1}}}},t.phonegap.defaultOptions={quality:50,destinationType:t.phonegap.CameraDefaults.DestinationType.DATA_URL,sourceType:t.phonegap.CameraDefaults.PictureSourceType.CAMERA,encodingType:t.phonegap.CameraDefaults.EncodingType.PNG,cameraDirection:t.phonegap.CameraDefaults.Direction.FRONT},a.exports=t},{}],3:[function(e,a){"use strict";var t;e("../config/static"),e("../factories/overlay"),t=["$scope","$http","Config","overlay","ngDialog","$rootScope",function(e,a,t,r,o){var i,n,c;return n=function(e){return t.base64Regex.test(e)},c=function(o){var i;return i={method:"POST",timeout:3e4,url:""+t.serverIP+"/upload",data:{b64:o.image,email:o.email}},a(i).success(function(a){return r.show("Vielen Dank für dein Selfie!"),e.imageName=a.file.name,console.log("error while uploading")}).error(function(){return e.imageName="",console.log("error while uploading")})},i=function(o){var i;return e.uploadRequested=!0,i={method:"POST",url:""+t.serverIP+"/email",data:{name:o.name,email:o.email}},a(i).success(function(a){return r.show("Email erfolgreich gesendet!"),console.log("success",a),e.uploadRequested=!1}).error(function(){return e.imageName="",e.uploadRequested=!1,r.show({text:"Hochladen fehlgeschlagen, versuch's doch nochmal!",type:"error"})})},e.imageSrc=t.imageSrc,e.videoStream="",e.imageAvailable=!1,e.uploadRequested=!1,e.imageName="",e.dialogModel={email:""},e.$watch("imageSrc",function(){return n(e.imageSrc)?c({image:e.imageSrc,email:e.dialogModel.email}):void 0}),e.onUploadClick=function(){var a;if(!e.uploadRequested)return n(e.imageSrc)?(a=o.openConfirm({template:"html/email_modal.html",scope:e}),a.then(function(){return i({name:e.imageName,email:e.dialogModel.email}),e.dialogModel.email=""})):r.show({text:"Kein Selfie gefunden! :(",type:"error"})},e.onDestroyClick=function(){return e.imageSrc=t.imageSrc,e.imageAvailable=!1}}],a.exports=t},{"../config/static":2,"../factories/overlay":8}],4:[function(e,a){"use strict";var t;e("../config/static"),e("../factories/cordova_ready"),e("../factories/camera_data"),e("../factories/overlay"),t=["cordovaReady","Config","cameraData","overlay",function(e,a,t,r){var o,i,n,c,u,s,l;return navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,n=function(e,a){return{video:{mandatory:{minWidth:e,maxWidth:e,minHeight:a,maxHeight:a}},audio:!1}},i=function(e,a){var t,r,o,i;return i=[e[0].width,e[0].height],r=i[0],t=i[1],o=document.querySelector("video"),o.setAttribute("width",r),o.setAttribute("height",t),navigator.getUserMedia(n(r,t),l(a),s(a))},l=function(e){return function(a){return console.log("success"),t.videoStream=a,t.videoBlob=URL.createObjectURL(a),e.videoStream=URL.createObjectURL(a),e.$apply(),t.videoRequested=!1}},s=function(e){return function(i){return console.log("err usermedia",i),t.videoRequested=!1,navigator.camera?o(e):(r.show("DevicesNotFoundError"===i.name?{type:"error",text:"Keine Kamera verfügbar"}:{type:"error",text:"Kamerafehler!"}),e.imageSrc=a.imageSrc,e.imageAvailable=!1,e.$apply())}},o=function(t){return e.ready().then(function(){return navigator.camera.getPicture(u(t),c,a.phonegap.defaultOptions)})},u=function(a){return function(t){return console.log("success phonegap"),a.imageAvailable=!0,a.imageSrc="data:image/png;base64,"+t,a.$apply(),e.ready().then(function(){return navigator.camera.cleanup(function(){},function(){})})}},c=function(){return toast.show({type:"error",text:"Kamerafehler :("}),scope.imageSrc=a.imageSrc,scope.imageAvailable=!1,scope.$apply()},{restrict:"A",link:function(e,a){return a.on("click",function(){return t.videoRequested||e.uploadRequested?void 0:(e.imageAvailable=!1,navigator.getUserMedia?(t.videoRequested=!0,i(a.find("img"),e)):o(e))})}}}],a.exports=t},{"../config/static":2,"../factories/camera_data":6,"../factories/cordova_ready":7,"../factories/overlay":8}],5:[function(e,a){"use strict";var t;e("../config/static"),e("../factories/camera_data"),t=["Config","cameraData",function(e,a){var t,r,o;return t=document.createElement("canvas"),r=t.getContext("2d"),o=function(e){var a,o,i;return i=[e.width,e.height],o=i[0],a=i[1],t.width=o,t.height=a,r.drawImage(e,0,0,o,a),t.toDataURL("image/png")},{restrict:"A",link:function(e,t){return t.on("click",function(){return e.imageSrc=o(t[0]),t[0].pause(),a.videoStream&&(a.videoStream.stop(),a.videoStream=null),e.imageAvailable=!0,e.videoStream=null,e.imageAvailable=!0,e.$apply(),a.videoRequested=!1})}}}],a.exports=t},{"../config/static":2,"../factories/camera_data":6}],6:[function(e,a){a.exports=[function(){return{}}]},{}],7:[function(e,a){var t;t=["$q","$rootScope","$document",function(e,a,t){var r;return r=e.defer(),t.bind("deviceready",function(){return a.$apply(r.resolve)}),{ready:function(){return r.promise}}}],a.exports=t},{}],8:[function(e,a){var t;t=["$timeout","$rootScope","$rootElement","$compile","$window",function(e,a,t,r){var o,i,n,c,u;return o={SUCCESS_CLASS:"fa fa-check fa-5x",ERROR_CLASS:"fa fa-times fa-5x"},i={duration:5e3,type:"success",text:"Success!",$scope:a.$new()},c=null,u=function(a,r){var o;return(o=document.querySelector(".toast"))&&o.remove(),r.addClass("toast-show"),t.append(r),c&&e.cancel(c),c=e(function(){return r.removeClass("toast-show").addClass("toast-hide"),c=null},a)},n=function(e){var a,t,i,n;return n="success"===e.type?o.SUCCESS_CLASS:o.ERROR_CLASS,i='<div class="toast">\n  <i class="'+n+'"></i>\n  <span>'+e.text+"</span>\n</div>",a=e.$scope,t=r(i)(a),u(e.duration,t)},{show:function(e){return"string"==typeof e&&(e={text:e}),e=angular.extend(i,e),n(e)}}}],a.exports=t},{}]},{},[1]);